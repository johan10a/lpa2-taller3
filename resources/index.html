<!doctype html>
<html lang="en">

<head>
        <title>Recursos - API Musical</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        <link rel="canonical" href="https://johan10a.github.io/lpa2-taller3/resources/">
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../assets/css/darcula-highlight.min.css">

        <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="../assets/css/dracula-ui.min.css">
        <link rel="stylesheet" href="../assets/css/mkdocs.min.css">
            <link href="../assets/_mkdocstrings.css" rel="stylesheet">

        
            <link  rel="icon" type="image/x-icon" href="../assets/img/favicon.ico">
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="drac-bg-black-secondary drac-text-grey-ternary drac-text drac-scrollbar-purple">

    <main class="d-flex">

        <!-- block sidebar -->
            <nav id="sidebar" class="sidebar drac-bg-black">
    <div class="custom-menu">
        <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Menu</span>
        </button>
    </div>

    <div class="p-4">
        

        <div class="drac-text-center">
            
                <span class="drac-text drac-line-height drac-text-white">API Musical</span>
            
        </div>

        <div class="drac-box flex-column">
            <ul class="dot-ul">
                <li><div class="dot-li drac-bg-cyan"></div></li>
                <li><div class="dot-li drac-bg-green"></div></li>
                <li><div class="dot-li drac-bg-orange"></div></li>
                <li><div class="dot-li drac-bg-pink"></div></li>
                <li><div class="dot-li drac-bg-purple"></div></li>
                <li><div class="dot-li drac-bg-red"></div></li>
                <li><div class="dot-li drac-bg-yellow"></div></li>
            </ul>
        </div>

        <hr class="drac-divider" />

        <!-- block menu -->
        <ul class="mb-5 drac-list drac-list-none">
            
            <li class="drac-box">
                <a href=".."
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Inicio
                </a>
            </li>
            <li class="drac-box">
                <a href=".."
                    class=" active 
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#documentación-collapse" aria-expanded="false">
                    Documentación
                </a>
                <div class="collapse" id="documentación-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="./"
            class=" active 
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Recursos
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../models/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Modelos
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../extensions/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Extensiones
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../config/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Configuración
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../api_models/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Modelos de API
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../utils/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Utilidades
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../app/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Aplicación Principal
        </a>
    </li>
                    </ul>
                </div>
            </li>
        </ul>
        <!-- endblock -->
    </div>
</nav>
        <!-- endblock -->

        <nav class="divider drac-bg-purple-cyan"></nav>

        <div class="content">
            <!-- block header -->
                <header>
    <nav class="navbar navbar-expand-xl drac-bg-purple">
        <div class="container-fluid">
            
            <button class="navbar-toggler w-100 text-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
                aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
                <ul class="navbar-nav text-md-center">

                    <!-- block preview -->
                    <li class="nav-item">
                            
        <div class="container">
            <div class="row row-preview">
                <div class="col">
                    <a href=".."
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </div>
                <div class="col">
                    <a href="../models/"
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover" style="padding-left: 3%;">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
                    </li>
                    <!--  endblock -->

                    <!-- block search -->
                    <li class="nav-item"><div role="search" class="search-box">
	<form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
		<input type="text" name="q" class="drac-input drac-input-search drac-input-white drac-text-white drac-bg-black-secondary"
		placeholder="Search docs" title="Type search term here" />
	</form>
</div>
                    </li>
                    <!--  endblock -->

                    <!-- block source -->
                    <li class="nav-item">
                        
                    </li>
                    <!--  endblock -->

                </ul>
            </div>

        </div>
    </nav>
</header>
            <!-- endblock -->

            <!-- block content -->
                <section class="p-md-5 section-content">
    <article>
        <p><h1 id="modulo-recursos">Módulo recursos</h1>


<div class="doc doc-object doc-module">



<a id="musica_api.resources"></a>
    <div class="doc doc-contents first">

        <p>Módulo de recursos de la API.
Define los endpoints, controladores y la lógica de negocio de la API.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.CancionAPI" class="doc doc-heading">
            <code>CancionAPI</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/canciones/&lt;int:id&gt;")
@ns.param("id", "Identificador único de la canción")
@ns.response(404, "Canción no encontrada")
class CancionAPI(Resource):
    @ns.doc("Obtener una canción por su ID")
    @ns.marshal_with(cancion_model)
    def get(self, id):
        """Obtiene una canción por su ID"""
        return Cancion.query.get_or_404(id), 200

    @ns.doc("Actualizar una canción")
    @ns.expect(cancion_base)
    @ns.marshal_with(cancion_model)
    def put(self, id):
        """Actualiza una canción existente"""
        cancion = Cancion.query.get_or_404(id)
        data = request.json

        cancion.titulo = data.get("titulo", cancion.titulo)
        cancion.artista = data.get("artista", cancion.artista)
        cancion.album = data.get("album", cancion.album)
        cancion.duracion = data.get("duracion", cancion.duracion)
        cancion.año = data.get("año", cancion.año)
        cancion.genero = data.get("genero", cancion.genero)

        try:
            db.session.commit()
            return cancion
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al actualizar canción: {str(e)}")

    @ns.doc("Eliminar una canción")
    @ns.response(204, "Canción eliminada con éxito")
    def delete(self, id):
        """Elimina una canción existente"""
        cancion = Cancion.query.get_or_404(id)
        try:
            db.session.delete(cancion)
            db.session.commit()
            return {}, 204
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al eliminar canción: {str(e)}")</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.CancionAPI.delete" class="doc doc-heading">
            <code class="highlight language-python">delete(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Elimina una canción existente</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Eliminar una canción")
@ns.response(204, "Canción eliminada con éxito")
def delete(self, id):
    """Elimina una canción existente"""
    cancion = Cancion.query.get_or_404(id)
    try:
        db.session.delete(cancion)
        db.session.commit()
        return {}, 204
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al eliminar canción: {str(e)}")</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.CancionAPI.get" class="doc doc-heading">
            <code class="highlight language-python">get(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Obtiene una canción por su ID</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Obtener una canción por su ID")
@ns.marshal_with(cancion_model)
def get(self, id):
    """Obtiene una canción por su ID"""
    return Cancion.query.get_or_404(id), 200</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.CancionAPI.put" class="doc doc-heading">
            <code class="highlight language-python">put(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Actualiza una canción existente</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Actualizar una canción")
@ns.expect(cancion_base)
@ns.marshal_with(cancion_model)
def put(self, id):
    """Actualiza una canción existente"""
    cancion = Cancion.query.get_or_404(id)
    data = request.json

    cancion.titulo = data.get("titulo", cancion.titulo)
    cancion.artista = data.get("artista", cancion.artista)
    cancion.album = data.get("album", cancion.album)
    cancion.duracion = data.get("duracion", cancion.duracion)
    cancion.año = data.get("año", cancion.año)
    cancion.genero = data.get("genero", cancion.genero)

    try:
        db.session.commit()
        return cancion
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al actualizar canción: {str(e)}")</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.CancionBusquedaAPI" class="doc doc-heading">
            <code>CancionBusquedaAPI</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/canciones/buscar")
class CancionBusquedaAPI(Resource):
    @ns.doc("Buscar canciones por título, artista o género")
    @ns.param("titulo", "Título de la canción (búsqueda parcial)")
    @ns.param("artista", "Nombre del artista (búsqueda parcial)")
    @ns.param("genero", "Género musical (búsqueda exacta)")
    @ns.marshal_list_with(cancion_model)
    def get(self):
        """Busca canciones por título, artista o género"""
        titulo = request.args.get("titulo")
        artista = request.args.get("artista")
        genero = request.args.get("genero")

        query = Cancion.query

        if titulo:
            query = query.filter(Cancion.titulo.ilike(f"%{titulo}%"))
        if artista:
            query = query.filter(Cancion.artista.ilike(f"%{artista}%"))
        if genero:
            query = query.filter(Cancion.genero == genero)

        return query.all(), 200</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.CancionBusquedaAPI.get" class="doc doc-heading">
            <code class="highlight language-python">get()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Busca canciones por título, artista o género</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Buscar canciones por título, artista o género")
@ns.param("titulo", "Título de la canción (búsqueda parcial)")
@ns.param("artista", "Nombre del artista (búsqueda parcial)")
@ns.param("genero", "Género musical (búsqueda exacta)")
@ns.marshal_list_with(cancion_model)
def get(self):
    """Busca canciones por título, artista o género"""
    titulo = request.args.get("titulo")
    artista = request.args.get("artista")
    genero = request.args.get("genero")

    query = Cancion.query

    if titulo:
        query = query.filter(Cancion.titulo.ilike(f"%{titulo}%"))
    if artista:
        query = query.filter(Cancion.artista.ilike(f"%{artista}%"))
    if genero:
        query = query.filter(Cancion.genero == genero)

    return query.all(), 200</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.CancionListAPI" class="doc doc-heading">
            <code>CancionListAPI</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/canciones")
class CancionListAPI(Resource):
    @ns.doc("Listar todas las canciones con paginación")
    @ns.param("page", "Número de página (por defecto 1)")
    @ns.param("per_page", "Cantidad por página (por defecto 4)")
    @ns.response(200, "Lista de canciones obtenida con éxito")
    @ns.marshal_list_with(cancion_model)
    def get(self):
        """Obtiene todas las canciones registradas (paginadas)"""
        page = int(request.args.get("page", 1))
        per_page = int(request.args.get("per_page", 4))

        canciones = Cancion.query.paginate(
            page=page, per_page=per_page, error_out=False
        )
        return canciones.items, 200

    @ns.doc("Crear una nueva canción")
    @ns.expect(cancion_base)
    @ns.response(201, "Canción creada con éxito")
    @ns.marshal_with(cancion_model)
    def post(self):
        """Crea una nueva canción"""
        data = request.json

        cancion = Cancion(
            titulo=data["titulo"],
            artista=data["artista"],
            album=data.get("album"),
            duracion=data.get("duracion"),
            año=data.get("año"),
            genero=data.get("genero"),
        )

        try:
            db.session.add(cancion)
            db.session.commit()
            return cancion, 201
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al crear canción: {str(e)}")</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.CancionListAPI.get" class="doc doc-heading">
            <code class="highlight language-python">get()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Obtiene todas las canciones registradas (paginadas)</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Listar todas las canciones con paginación")
@ns.param("page", "Número de página (por defecto 1)")
@ns.param("per_page", "Cantidad por página (por defecto 4)")
@ns.response(200, "Lista de canciones obtenida con éxito")
@ns.marshal_list_with(cancion_model)
def get(self):
    """Obtiene todas las canciones registradas (paginadas)"""
    page = int(request.args.get("page", 1))
    per_page = int(request.args.get("per_page", 4))

    canciones = Cancion.query.paginate(
        page=page, per_page=per_page, error_out=False
    )
    return canciones.items, 200</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.CancionListAPI.post" class="doc doc-heading">
            <code class="highlight language-python">post()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Crea una nueva canción</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Crear una nueva canción")
@ns.expect(cancion_base)
@ns.response(201, "Canción creada con éxito")
@ns.marshal_with(cancion_model)
def post(self):
    """Crea una nueva canción"""
    data = request.json

    cancion = Cancion(
        titulo=data["titulo"],
        artista=data["artista"],
        album=data.get("album"),
        duracion=data.get("duracion"),
        año=data.get("año"),
        genero=data.get("genero"),
    )

    try:
        db.session.add(cancion)
        db.session.commit()
        return cancion, 201
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al crear canción: {str(e)}")</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.FavoritoAPI" class="doc doc-heading">
            <code>FavoritoAPI</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/favoritos/&lt;int:id&gt;")
@ns.param("id", "Identificador único del favorito")
@ns.response(404, "Favorito no encontrado")
class FavoritoAPI(Resource):
    @ns.doc("Obtener un favorito por su ID")
    @ns.marshal_with(favorito_model)
    def get(self, id):
        """Obtiene un registro de favorito por su ID"""
        return Favorito.query.get_or_404(id), 200

    @ns.doc("Eliminar un favorito")
    @ns.response(204, "Favorito eliminado con éxito")
    def delete(self, id):
        """Elimina un registro de favorito existente"""
        favorito = Favorito.query.get_or_404(id)
        try:
            db.session.delete(favorito)
            db.session.commit()
            return {}, 204
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al eliminar favorito: {str(e)}")</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.FavoritoAPI.delete" class="doc doc-heading">
            <code class="highlight language-python">delete(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Elimina un registro de favorito existente</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Eliminar un favorito")
@ns.response(204, "Favorito eliminado con éxito")
def delete(self, id):
    """Elimina un registro de favorito existente"""
    favorito = Favorito.query.get_or_404(id)
    try:
        db.session.delete(favorito)
        db.session.commit()
        return {}, 204
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al eliminar favorito: {str(e)}")</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.FavoritoAPI.get" class="doc doc-heading">
            <code class="highlight language-python">get(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Obtiene un registro de favorito por su ID</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Obtener un favorito por su ID")
@ns.marshal_with(favorito_model)
def get(self, id):
    """Obtiene un registro de favorito por su ID"""
    return Favorito.query.get_or_404(id), 200</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.Home" class="doc doc-heading">
            <code>Home</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/")
class Home(Resource):
    @ns.doc("Página principal de la API")
    @ns.marshal_with(mensaje_model)
    def get(self):
        """Mensaje de bienvenida en la raíz de la API"""
        return {
            "mensaje": "Bienvenido a la API de Música. Visita /docs para la documentación."
        }, 200</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.Home.get" class="doc doc-heading">
            <code class="highlight language-python">get()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Mensaje de bienvenida en la raíz de la API</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Página principal de la API")
@ns.marshal_with(mensaje_model)
def get(self):
    """Mensaje de bienvenida en la raíz de la API"""
    return {
        "mensaje": "Bienvenido a la API de Música. Visita /docs para la documentación."
    }, 200</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.Ping" class="doc doc-heading">
            <code>Ping</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/ping")
class Ping(Resource):
    @ns.response(200, "API funcionando correctamente")
    @ns.marshal_with(mensaje_model)
    def get(self):
        """Endpoint para verificar que la API está funcionando"""
        return {"mensaje": "La API está funcionando correctamente"}, 200</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.Ping.get" class="doc doc-heading">
            <code class="highlight language-python">get()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Endpoint para verificar que la API está funcionando</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.response(200, "API funcionando correctamente")
@ns.marshal_with(mensaje_model)
def get(self):
    """Endpoint para verificar que la API está funcionando"""
    return {"mensaje": "La API está funcionando correctamente"}, 200</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.UsuarioAPI" class="doc doc-heading">
            <code>UsuarioAPI</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/usuarios/&lt;int:id&gt;")
@ns.param("id", "Identificador único del usuario")
@ns.response(404, "Usuario no encontrado")
class UsuarioAPI(Resource):
    @ns.doc("Obtener un usuario por su ID")
    @ns.marshal_with(usuario_model)
    def get(self, id):
        """Obtiene un usuario por su ID"""
        return Usuario.query.get_or_404(id), 200

    @ns.doc("Actualizar un usuario")
    @ns.expect(usuario_base)
    @ns.marshal_with(usuario_model)
    def put(self, id):
        """Actualiza un usuario existente"""
        usuario = Usuario.query.get_or_404(id)
        data = request.json

        if "correo" in data and data["correo"] != usuario.correo:
            if Usuario.query.filter_by(correo=data["correo"]).first():
                ns.abort(400, "El correo electrónico ya está registrado")

        usuario.nombre = data.get("nombre", usuario.nombre)
        usuario.correo = data.get("correo", usuario.correo)

        try:
            db.session.commit()
            return usuario
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al actualizar usuario: {str(e)}")

    @ns.doc("Eliminar un usuario")
    @ns.response(204, "Usuario eliminado con éxito")
    def delete(self, id):
        """Elimina un usuario existente"""
        usuario = Usuario.query.get_or_404(id)
        try:
            db.session.delete(usuario)
            db.session.commit()
            return {}, 204
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al eliminar usuario: {str(e)}")</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.UsuarioAPI.delete" class="doc doc-heading">
            <code class="highlight language-python">delete(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Elimina un usuario existente</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Eliminar un usuario")
@ns.response(204, "Usuario eliminado con éxito")
def delete(self, id):
    """Elimina un usuario existente"""
    usuario = Usuario.query.get_or_404(id)
    try:
        db.session.delete(usuario)
        db.session.commit()
        return {}, 204
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al eliminar usuario: {str(e)}")</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.UsuarioAPI.get" class="doc doc-heading">
            <code class="highlight language-python">get(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Obtiene un usuario por su ID</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Obtener un usuario por su ID")
@ns.marshal_with(usuario_model)
def get(self, id):
    """Obtiene un usuario por su ID"""
    return Usuario.query.get_or_404(id), 200</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.UsuarioAPI.put" class="doc doc-heading">
            <code class="highlight language-python">put(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Actualiza un usuario existente</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Actualizar un usuario")
@ns.expect(usuario_base)
@ns.marshal_with(usuario_model)
def put(self, id):
    """Actualiza un usuario existente"""
    usuario = Usuario.query.get_or_404(id)
    data = request.json

    if "correo" in data and data["correo"] != usuario.correo:
        if Usuario.query.filter_by(correo=data["correo"]).first():
            ns.abort(400, "El correo electrónico ya está registrado")

    usuario.nombre = data.get("nombre", usuario.nombre)
    usuario.correo = data.get("correo", usuario.correo)

    try:
        db.session.commit()
        return usuario
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al actualizar usuario: {str(e)}")</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.UsuarioCancionFavoritoAPI" class="doc doc-heading">
            <code>UsuarioCancionFavoritoAPI</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/usuarios/&lt;int:id_usuario&gt;/favoritos/&lt;int:id_cancion&gt;")
@ns.param("id_usuario", "Identificador único del usuario")
@ns.param("id_cancion", "Identificador único de la canción")
class UsuarioCancionFavoritoAPI(Resource):
    @ns.doc("Marcar o desmarcar una canción como favorita para un usuario")
    @ns.response(201, "Canción marcada como favorita")
    @ns.response(204, "Canción desmarcada como favorita")
    @ns.response(404, "Usuario o canción no encontrada")
    def post(self, id_usuario, id_cancion):
        """Marca una canción como favorita para un usuario"""
        usuario = Usuario.query.get(id_usuario)
        cancion = Cancion.query.get(id_cancion)

        if not usuario:
            ns.abort(404, "Usuario no encontrado")
        if not cancion:
            ns.abort(404, "Canción no encontrada")

        favorito = Favorito.query.filter_by(
            id_usuario=id_usuario, id_cancion=id_cancion
        ).first()

        if favorito:
            ns.abort(400, "La canción ya está marcada como favorita para este usuario")

        favorito = Favorito(id_usuario=id_usuario, id_cancion=id_cancion)

        try:
            db.session.add(favorito)
            db.session.commit()
            return {"mensaje": "Canción marcada como favorita"}, 201
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al marcar como favorito: {str(e)}")

    @ns.doc("Eliminar una canción de favoritos")
    @ns.response(204, "Canción eliminada de favoritos")
    @ns.response(404, "Relación de favorito no encontrada")
    def delete(self, id_usuario, id_cancion):
        """Elimina una canción de favoritos para un usuario"""
        favorito = Favorito.query.filter_by(
            id_usuario=id_usuario, id_cancion=id_cancion
        ).first_or_404("Relación de favorito no encontrada")

        try:
            db.session.delete(favorito)
            db.session.commit()
            return {}, 204
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al eliminar favorito: {str(e)}")</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.UsuarioCancionFavoritoAPI.delete" class="doc doc-heading">
            <code class="highlight language-python">delete(id_usuario, id_cancion)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Elimina una canción de favoritos para un usuario</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Eliminar una canción de favoritos")
@ns.response(204, "Canción eliminada de favoritos")
@ns.response(404, "Relación de favorito no encontrada")
def delete(self, id_usuario, id_cancion):
    """Elimina una canción de favoritos para un usuario"""
    favorito = Favorito.query.filter_by(
        id_usuario=id_usuario, id_cancion=id_cancion
    ).first_or_404("Relación de favorito no encontrada")

    try:
        db.session.delete(favorito)
        db.session.commit()
        return {}, 204
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al eliminar favorito: {str(e)}")</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.UsuarioCancionFavoritoAPI.post" class="doc doc-heading">
            <code class="highlight language-python">post(id_usuario, id_cancion)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Marca una canción como favorita para un usuario</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Marcar o desmarcar una canción como favorita para un usuario")
@ns.response(201, "Canción marcada como favorita")
@ns.response(204, "Canción desmarcada como favorita")
@ns.response(404, "Usuario o canción no encontrada")
def post(self, id_usuario, id_cancion):
    """Marca una canción como favorita para un usuario"""
    usuario = Usuario.query.get(id_usuario)
    cancion = Cancion.query.get(id_cancion)

    if not usuario:
        ns.abort(404, "Usuario no encontrado")
    if not cancion:
        ns.abort(404, "Canción no encontrada")

    favorito = Favorito.query.filter_by(
        id_usuario=id_usuario, id_cancion=id_cancion
    ).first()

    if favorito:
        ns.abort(400, "La canción ya está marcada como favorita para este usuario")

    favorito = Favorito(id_usuario=id_usuario, id_cancion=id_cancion)

    try:
        db.session.add(favorito)
        db.session.commit()
        return {"mensaje": "Canción marcada como favorita"}, 201
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al marcar como favorito: {str(e)}")</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.UsuarioFavoritosAPI" class="doc doc-heading">
            <code>UsuarioFavoritosAPI</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/usuarios/&lt;int:id&gt;/favoritos")
@ns.param("id", "Identificador único del usuario")
@ns.response(404, "Usuario no encontrado")
class UsuarioFavoritosAPI(Resource):
    @ns.doc("Obtener las canciones favoritas de un usuario")
    @ns.marshal_with(favoritos_usuario_model)
    def get(self, id):
        """Obtiene todas las canciones favoritas de un usuario"""
        usuario = Usuario.query.get_or_404(id)

        favoritos = Favorito.query.filter_by(id_usuario=id).all()
        canciones_favoritas = [
            {
                "id": favorito.cancion.id,
                "titulo": favorito.cancion.titulo,
                "artista": favorito.cancion.artista,
            }
            for favorito in favoritos
        ]

        return {
            "usuario": {"id": usuario.id, "nombre": usuario.nombre},
            "canciones_favoritas": canciones_favoritas,
        }, 200</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.UsuarioFavoritosAPI.get" class="doc doc-heading">
            <code class="highlight language-python">get(id)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Obtiene todas las canciones favoritas de un usuario</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Obtener las canciones favoritas de un usuario")
@ns.marshal_with(favoritos_usuario_model)
def get(self, id):
    """Obtiene todas las canciones favoritas de un usuario"""
    usuario = Usuario.query.get_or_404(id)

    favoritos = Favorito.query.filter_by(id_usuario=id).all()
    canciones_favoritas = [
        {
            "id": favorito.cancion.id,
            "titulo": favorito.cancion.titulo,
            "artista": favorito.cancion.artista,
        }
        for favorito in favoritos
    ]

    return {
        "usuario": {"id": usuario.id, "nombre": usuario.nombre},
        "canciones_favoritas": canciones_favoritas,
    }, 200</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="musica_api.resources.UsuarioListAPI" class="doc doc-heading">
            <code>UsuarioListAPI</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask_restx.Resource">Resource</span></code></p>








              <details class="quote">
                <summary>Source code in <code>musica_api\resources.py</code></summary>
                <pre class="highlight"><code class="language-python">@ns.route("/usuarios")
class UsuarioListAPI(Resource):
    @ns.doc("Listar todos los usuarios con paginación")
    @ns.param("page", "Número de página (por defecto 1)")
    @ns.param("per_page", "Cantidad por página (por defecto 4)")
    @ns.response(200, "Lista de usuarios obtenida con éxito")
    @ns.marshal_list_with(usuario_model)
    def get(self):
        """Obtiene todos los usuarios registrados (paginados)"""
        page = int(request.args.get("page", 1))
        per_page = int(request.args.get("per_page", 4))
        usuarios = Usuario.query.paginate(page=page, per_page=per_page, error_out=False)
        return usuarios.items, 200

    @ns.doc("Marcar una canción como favorita")
    @ns.expect(favorito_input)
    @ns.response(201, "Canción marcada como favorita")
    @ns.response(400, "Datos inválidos o relación ya existe")
    @ns.response(404, "Usuario o canción no encontrada")
    @ns.marshal_with(favorito_model)
    def post(self):
        """Marca una canción como favorita para un usuario"""
        data = request.json

        usuario = Usuario.query.get(data["id_usuario"])
        cancion = Cancion.query.get(data["id_cancion"])

        if not usuario:
            ns.abort(404, "Usuario no encontrado")
        if not cancion:
            ns.abort(404, "Canción no encontrada")

        favorito_existente = Favorito.query.filter_by(
            id_usuario=data["id_usuario"], id_cancion=data["id_cancion"]
        ).first()

        if favorito_existente:
            ns.abort(400, "La canción ya está marcada como favorita para este usuario")

        favorito = Favorito(
            id_usuario=data["id_usuario"], id_cancion=data["id_cancion"]
        )

        try:
            db.session.add(favorito)
            db.session.commit()
            return favorito, 201
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al marcar como favorito: {str(e)}")</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.UsuarioListAPI.get" class="doc doc-heading">
            <code class="highlight language-python">get()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Obtiene todos los usuarios registrados (paginados)</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Listar todos los usuarios con paginación")
@ns.param("page", "Número de página (por defecto 1)")
@ns.param("per_page", "Cantidad por página (por defecto 4)")
@ns.response(200, "Lista de usuarios obtenida con éxito")
@ns.marshal_list_with(usuario_model)
def get(self):
    """Obtiene todos los usuarios registrados (paginados)"""
    page = int(request.args.get("page", 1))
    per_page = int(request.args.get("per_page", 4))
    usuarios = Usuario.query.paginate(page=page, per_page=per_page, error_out=False)
    return usuarios.items, 200</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="musica_api.resources.UsuarioListAPI.post" class="doc doc-heading">
            <code class="highlight language-python">post()</code>

</h3>


    <div class="doc doc-contents ">

        <p>Marca una canción como favorita para un usuario</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Marcar una canción como favorita")
@ns.expect(favorito_input)
@ns.response(201, "Canción marcada como favorita")
@ns.response(400, "Datos inválidos o relación ya existe")
@ns.response(404, "Usuario o canción no encontrada")
@ns.marshal_with(favorito_model)
def post(self):
    """Marca una canción como favorita para un usuario"""
    data = request.json

    usuario = Usuario.query.get(data["id_usuario"])
    cancion = Cancion.query.get(data["id_cancion"])

    if not usuario:
        ns.abort(404, "Usuario no encontrado")
    if not cancion:
        ns.abort(404, "Canción no encontrada")

    favorito_existente = Favorito.query.filter_by(
        id_usuario=data["id_usuario"], id_cancion=data["id_cancion"]
    ).first()

    if favorito_existente:
        ns.abort(400, "La canción ya está marcada como favorita para este usuario")

    favorito = Favorito(
        id_usuario=data["id_usuario"], id_cancion=data["id_cancion"]
    )

    try:
        db.session.add(favorito)
        db.session.commit()
        return favorito, 201
    except Exception as e:
        db.session.rollback()
        ns.abort(400, f"Error al marcar como favorito: {str(e)}")</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="musica_api.resources.get" class="doc doc-heading">
            <code class="highlight language-python">get(self)</code>

</h2>


    <div class="doc doc-contents ">

        <p>Obtiene todos los usuarios registrados (paginados)</p>


            <details class="quote">
              <summary>Source code in <code>musica_api\resources.py</code></summary>
              <pre class="highlight"><code class="language-python">@ns.doc("Listar todos los usuarios con paginación")
@ns.param("page", "Número de página (por defecto 1)")
@ns.param("per_page", "Cantidad por página (por defecto 4)")
@ns.response(200, "Lista de usuarios obtenida con éxito")
@ns.marshal_list_with(usuario_model)
def get(self):
    """Obtiene todos los usuarios registrados (paginados)"""
    page = int(request.args.get("page", 1))
    per_page = int(request.args.get("per_page", 4))

    usuarios = Usuario.query.paginate(page=page, per_page=per_page, error_out=False)
    return usuarios.items, 200

    @ns.doc("Crear un nuevo usuario")
    @ns.expect(usuario_base)
    @ns.response(201, "Usuario creado con éxito")
    @ns.response(400, "Datos inválidos o correo ya existe")
    @ns.marshal_with(usuario_model)
    def post(self):
        """Crea un nuevo usuario"""
        data = request.json

        if Usuario.query.filter_by(correo=data["correo"]).first():
            ns.abort(400, "El correo electrónico ya está registrado")

        usuario = Usuario(nombre=data["nombre"], correo=data["correo"])

        try:
            db.session.add(usuario)
            db.session.commit()
            return usuario, 201
        except Exception as e:
            db.session.rollback()
            ns.abort(400, f"Error al crear usuario: {str(e)}")</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div></p>
    </article>
</section>
            <!-- endblock -->

            <!-- block footer -->
                <footer>
    <div class="d-flex flex-sm-row justify-content-between py-2 border-top drac-text-black drac-bg-cyan-green">
        <a href="https://github.com/dracula/mkdocs" target="_blank" style="padding-left: 1%;"
            class="footer-text drac-anchor drac-text-black drac-text-purple--hover">
            Made with Dracula Theme for MkDocs
        </a>
    </div>
</footer>
            <!-- endblock -->
        </div>

    </main>

        <script>var base_url = '..';</script>
        <script src="../assets/js/jquery-3.3.1.slim.min.js"></script>
        <script src="../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../assets/js/mkdocs.js"></script>
			<script src="../search/main.js" defer></script>

</body>

</html>